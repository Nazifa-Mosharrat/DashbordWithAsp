
@{
    ViewBag.Title = "Home Page";
}

<script src="https://momentjs.com/downloads/moment.min.js"></script>


<section class="content">
    <div class="container-fluid">
        <!-- Small boxes (Stat box) -->
        <div class="row">

            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-info">
                    <div class="inner">
                        <h3 class="TotalJobs">@ViewBag.TotalJob</h3>
                        <p>Total Jobs</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-bag"></i>
                    </div>
                    @*<a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>*@
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-success">
                    <div class="inner">
                        <h3 class="JobDone">@ViewBag.JobDone</h3>

                        <p>Job Done</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-stats-bars"></i>
                    </div>
                    @*<a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>*@
                </div>
            </div>
            <!-- ./col -->
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-warning">
                    <div class="inner">
                        <h3 class="JobInProgress">@ViewBag.JobInProgress</h3>

                        <p>Job In Progress</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    @*<a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>*@
                </div>
            </div>
            <div class="col-lg-3 col-6">
                <!-- small box -->
                <div class="small-box bg-danger">
                    <div class="inner">
                        <h3 class="TotalClients">@ViewBag.TotalClients</h3>

                        <p>Total Clients</p>
                    </div>
                    <div class="icon">
                        <i class="ion ion-person-add"></i>
                    </div>
                    @*<a href="#" class="small-box-footer">More info <i class="fas fa-arrow-circle-right"></i></a>*@
                </div>
            </div>
        </div>
        <!-- /.row -->
        <!-- Main row -->
        <!-- /.row (main row) -->
    </div><!-- /.container-fluid -->
</section>

<!-- DONUT CHART -->
<section class="content">
    <div class="row">
        <div class="col-md-4">
            <div class="card card-danger">
                <div class="card-header">
                    <h3 class="card-title">Donut Chart</h3>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-tool" data-card-widget="remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                @*<div class="card-body">
                        <div>
                            <canvas id="myChart"></canvas>
                        </div>
                        <div></div>
                        <canvas id="donutChart" style="min-height: 500px; height: 500px; max-height: 500px; max-width: 100%;"></canvas>
                    </div>*@

                <div class="card-body">
                    <div class="col-md-12">
                        <canvas id="myChart" height="300"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="card card-danger">
                <div class="card-header">
                    <h3 class="card-title">Line Chart</h3>
                    <div class="card-tools">
                        <button type="button" class="btn btn-tool" data-card-widget="collapse">
                            <i class="fas fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-tool" data-card-widget="remove">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                @*<div class="card-body">
                        <div>
                            <canvas id="myChart"></canvas>
                        </div>
                        <div></div>
                        <canvas id="donutChart" style="min-height: 500px; height: 500px; max-height: 500px; max-width: 100%;"></canvas>
                    </div>*@

                <div class="card-body">
                    <div class="col-md-12">
                        <canvas id="myLineChart" height="140"></canvas>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.card-body -->
    </div>
    <div class="col-md-6">
        <div class="card card-danger">
            <div class="card-header">
                <h3 class="card-title">Bar Chart</h3>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                    <button type="button" class="btn btn-tool" data-card-widget="remove">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div hidden>
            <h3 class="clientName">@ViewBag.clientName</h3>
            <h3 class="ClientWiseJob">@ViewBag.ClientWiseJob</h3>
        </div>

            <div class="card-body">
                <div class="col-md-12">
                    <canvas id="canvas" height="300"></canvas>
                </div>
            </div>
            @*<div style="width: 75%">
                <canvas id="canvas" height="300"></canvas>
            </div>*@

        </div>
    </div>
</section>

@Scripts.Render("~/bundles/jquery")
<script src="https://code.highcharts.com/highcharts.src.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<script>

            //var ctx = document.getElementById("donutChart").getContext('2d');
            var ctx = document.getElementById("myChart").getContext('2d');
            var cty = document.getElementById("myLineChart").getContext('2d');
            //var ctb = document.getElementById("myBarChart").getContext('2d');
            var ClientName = document.querySelector(".clientName").textContent;
            var ClientWiseJob = document.querySelector(".ClientWiseJob").textContent;
            var TotalJobs = document.querySelector(".TotalJobs").textContent;
            var JobDone = document.querySelector(".JobDone").textContent;
            var JobInProcess = document.querySelector(".JobInProgress").textContent;
            var TotalClients = document.querySelector(".TotalClients").textContent;
    var dateFormat = function (dt) {

        var myDate = moment.utc(dt);
        return myDate.format('DD-MMM-YYYY');

    };
            // Pie Chart
            var myChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ["Total Jobs", "Job Done", "Job In Process", "Total Clients"],
                    datasets: [{
                        backgroundColor: [
                            "#2ecc71",
                            "#3498db",
                            "#95a5a6",
                            "#9b59b6",

                        ],
                        data: [TotalJobs, 19, 3, 17]
                    }]
                }
            });

            // Line Chart
            var myLineChart = new Chart(cty, {
                type: 'line',
                data: {
                    labels: ['Sat', 'Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri'],
                    datasets: [{
                        label: 'Job Done',
                        data: [JobDone],
                        backgroundColor: "rgba(153,255,51,0.6)"
                    }, {
                        label: 'Job In Process',
                        data: [JobInProcess],
                        backgroundColor: "rgba(255,153,0,0.6)"
                    }]
                }
            });

            

            //bar chart
            window.chartColors = {
                red: 'rgb(255, 99, 132)',
                orange: 'rgb(255, 159, 64)',
                yellow: 'rgb(255, 205, 86)',
                green: 'rgb(75, 192, 192)',
                blue: 'rgb(54, 162, 235)',
                purple: 'rgb(153, 102, 255)',
                grey: 'rgb(231,233,237)'
            };

            var ctx = document.getElementById("canvas").getContext("2d");
            var clientName   =[];
            //var jobDate      =[];
            var ClientWiseJob=[];

             $.ajax({
                 url: '@Url.Action("GetJobList", "Home")',
                 type: "get",
                 contentType: 'application/x-www-form-urlencoded',
                 
                 success: function (result) {
                     for (var i = 0; i < result.length; i++) {
                         clientName[i] = result[i].ClientName;                       
                         ClientWiseJob[i] = result[i].JobID;
                     }
                     console.log(result);
                     console.log(clientName);
                 }
             });
            var myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: clientName,
                    datasets: [{
                        type: 'line',
                        label: 'Client Name',
                        borderColor: window.chartColors.orange,
                        borderWidth: 2,
                        fill: false,
                        data: clientName
                    },
                        //{
                        //type: 'bar',
                        //label: 'Client Name',
                        //backgroundColor: window.chartColors.red,
                        //stack: 'Stack 0',
                        //data: clientName,
                        //borderColor: 'white',
                        //borderWidth: 2
                        //},
                        {
                        type: 'bar',
                        label: 'Total Job',
                        backgroundColor: window.chartColors.blue,
                        stack: 'Stack 0',
                        data: ClientWiseJob
                    }]
                },
                options: {
                    responsive: true,
                    title: {
                        display: true,
                        text: 'Line Combo Chart'
                    },
                    tooltips: {
                        mode: 'index',
                        intersect: true
                    },
                    scales: {
                        xAxes: [{
                            stacked: true,
                        }]
                    }
                }
            });

</script>
